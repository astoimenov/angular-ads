"use strict";var adsApp=angular.module("adsApp",["ngRoute","ngResource","LocalStorageModule","validation.match","ui.bootstrap.pagination"]).config(["$routeProvider","localStorageServiceProvider",function(e,t){e.when("/",{title:"Home",templateUrl:"templates/home.html",controller:"HomeCtrl"}),e.when("/login",{title:"Login",templateUrl:"templates/login.html",controller:"LoginCtrl"}),e.when("/register",{title:"Register",templateUrl:"templates/register.html",controller:"RegisterCtrl"}),e.when("/user/home",{title:"Home",templateUrl:"templates/user-home.html",controller:"UserHomeCtrl"}),e.when("/user/ads",{title:"My ads",templateUrl:"templates/user-home.html",controller:"UserAdsCtrl"}),e.when("/user/ads/publish",{title:"Publish new ad",templateUrl:"templates/publish-new-ad.html",controller:"PublishNewAdCtrl"}),e.when("/user/ads/edit/:id",{title:"Edit ad",templateUrl:"templates/edit-ad.html",controller:"EditAdCtrl"}),e.when("/user/ads/delete/:id",{title:"Delete ad",templateUrl:"templates/delete-ad.html",controller:"DeleteAdCtrl"}),e.when("/user/profile",{title:"Edit user profile",templateUrl:"templates/edit-profile.html",controller:"EditProfileCtrl"}),e.otherwise({redirectTo:"/"}),t.setStorageType("localStorage")}]);adsApp.constant("baseServiceUrl","http://softuni-ads.azurewebsites.net/api/"),adsApp.constant("pageSize",5),adsApp.run(["$rootScope","$location","authentication",function(e,t,r){e.$on("$routeChangeSuccess",function(t,r){e.title=r.$$route.title}),e.$on("$locationChangeStart",function(){-1==t.path().indexOf("/user/")||r.isLoggedIn()||t.path("/")})}]),adsApp.controller("DeleteAdCtrl",["$scope","$location","$routeParams","userAdsData","notification",function(e,t,r,a,o){var n=r.id;a.getAdById(n).$promise.then(function(t){e.ad=t},function(e){o.showError("Advertisement can not be deleted",e)}),e.delete=function(e){a.delete(e).$promise.then(function(){o.showInfo("Advertisement deleted"),t.path("/user/ads")},function(e){o.showError("Advertisement can not be deleted",e)})}}]),adsApp.controller("EditAdCtrl",["$scope","$routeParams","$location","townsData","categoriesData","userAdsData","notification",function(e,t,r,a,o,n,i){var s=t.id,d=!1;n.getAdById(s).$promise.then(function(t){e.adData=t},function(e){i.showError("Advertisement can not be edited",e)}),e.categories=o.getCategories(),e.towns=a.getTowns(),e.deleteImage=function(){delete e.adData.imageDataUrl,d=!0},e.fileSelected=function(t){delete e.adData.imageDataUrl;var r=t.files[0];if(r.type.match(/image\/.*/)){var a=new FileReader;a.onload=function(){e.adData.imageDataUrl=a.result,d=!0,$(".image-box").html("<img src='"+a.result+"'>")},a.readAsDataURL(r)}else $(".image-box").html("<p>File type not supported!</p>")},e.edit=function(e){e.changeImage=d,n.edit(s,e).$promise.then(function(){i.showInfo("Advertisement edited. Don't forget to submit it for publishing."),r.path("/user/ads")},function(e){i.showError("Editing failed",e)})}}]),adsApp.controller("EditProfileCtrl",["$scope","$location","townsData","userData","notification",function(e,t,r,a,o){e.pass={oldPassword:null,newPassword:null,confirmPassword:null},r.getTowns().$promise.then(function(t){e.towns=t}),a.getUserProfile().$promise.then(function(t){e.user=t}),e.edit=function(e){a.edit(e).$promise.then(function(){o.showInfo("User profile successfully updated."),t.path("/user/ads")},function(e){o.showError("User profile is not updated.",e)})},e.changePassword=function(e){a.changePassword(e).$promise.then(function(){o.showInfo("Password successfully updated."),t.path("/user/ads")},function(e){o.showError("Password is not updated.",e)})}}]),adsApp.controller("HomeCtrl",["$scope","$location","$route","userData","authentication",function(e,t,r,a,o){e.authentication=o,e.isLoggedIn=o.isLoggedIn(),e.logout=function(e){a.logout(e),"/"==t.$$path?r.reload():t.path("/")}}]),adsApp.controller("LoginCtrl",["$scope","$location","userData","notification",function(e,t,r,a){e.login=function(e){r.login(e).$promise.then(function(){a.showInfo("Login successful"),t.path("/user/home")},function(e){a.showError("Invalid login",e)})}}]),adsApp.controller("ManageAdMenuCtrl",["$scope","$route","userAdsData","notification",function(e,t,r,a){e.deactivate=function(e){r.deactivate(e).$promise.then(function(){a.showInfo("Ad is deactivated"),t.reload()},function(e){a.showError("Can't deactivate the ad",e)})},e.publishAgain=function(e){r.publishAgain(e).$promise.then(function(){a.showInfo("Ad is published again for approval."),t.reload()},function(e){a.showError("Can't publish the ad",e)})}}]),adsApp.controller("PublicAdsCtrl",["$scope","adsData","pageSize","notification",function(e,t,r,a){e.ready=!1,e.adsParams={startPage:1,pageSize:r},e.reloadAds=function(){t.getPublicAds(e.adsParams).$promise.then(function(t){e.ads=t,e.ready=!0},function(e){a.showError("Cannot load ads",e)})},e.reloadAds(),e.$on("categorySelectionChanged",function(t,r){e.adsParams.categoryId=r,e.adsParams.startPage=1,e.reloadAds()}),e.$on("townSelectionChanged",function(t,r){e.adsParams.townId=r,e.adsParams.startPage=1,e.reloadAds()})}]),adsApp.controller("PublishNewAdCtrl",["$scope","$location","townsData","categoriesData","userAdsData","notification",function(e,t,r,a,o,n){e.adData={townId:null,categoryId:null},e.categories=a.getCategories(),e.towns=r.getTowns(),e.fileSelected=function(t){delete e.adData.imageDataUrl;var r=t.files[0];if(r.type.match(/image\/.*/)){var a=new FileReader;a.onload=function(){e.adData.imageDataUrl=a.result,$(".image-box").html("<img src='"+a.result+"'>")},a.readAsDataURL(r)}else $(".image-box").html("<p>File type not supported!</p>")},e.publishAd=function(e){null==e.imageDataUrl&&(e.imageDataUrl=""),o.add(e).$promise.then(function(){n.showInfo("Advertisement submitted dor approval. Once approved, it will be published."),t.path("/user/ads")},function(e){n.showError("Publishing failed",e)})}}]),adsApp.controller("RegisterCtrl",["$scope","$location","townsData","userData","notification",function(e,t,r,a,o){r.getTowns().$promise.then(function(t){e.towns=t}),e.register=function(e){a.register(e).$promise.then(function(){o.showInfo("User account created. Please log in."),t.path("/login")},function(e){o.showError("Invalid registration",e)})}}]),adsApp.controller("RightSidebarCtrl",["$scope","$rootScope","townsData","categoriesData",function(e,t,r,a){e.categories=a.getCategories(),e.towns=r.getTowns(),e.categoryClicked=function(r){e.selectedCategoryId=r,t.$broadcast("categorySelectionChanged",r)},e.townClicked=function(r){e.selectedTownId=r,t.$broadcast("townSelectionChanged",r)}}]),adsApp.controller("StatusFilterCtrl",["$scope","$rootScope",function(e,t){e.statusClicked=function(r){e.selectedStatusId=r,t.$broadcast("statusSelectionChanged",r)}}]),adsApp.controller("UserAdsCtrl",["$scope","$route","adsData","userAdsData","userData","pageSize","notification",function(e,t,r,a,o,n,i){e.inMyAds=!0,e.ready=!1,e.adsParams={startPage:1,pageSize:n},e.reloadAds=function(){a.getUserAds(e.adsParams).$promise.then(function(t){e.ads=t,e.ready=!0,o.getUserProfile(function(t){e.ownerData=t})},function(e){i.showError("Cannot load ads",e)})},e.reloadAds(),e.$on("categorySelectionChanged",function(t,r){e.adsParams.categoryId=r,e.adsParams.startPage=1,e.reloadAds()}),e.$on("townSelectionChanged",function(t,r){e.adsParams.townId=r,e.adsParams.startPage=1,e.reloadAds()}),e.$on("statusSelectionChanged",function(t,r){e.adsParams.status=r,e.adsParams.startPage=1,e.reloadAds()})}]),adsApp.controller("UserHomeCtrl",["$scope","$location","$route","userData","authentication",function(e,t,r,a,o){e.authentication=o,e.isLoggedIn=o.isLoggedIn(),e.inHome="/user/home"==t.$$path,e.inMyAds="/user/ads"==t.$$path,e.inPublishNew="/user/ads/publish"==t.$$path,e.logout=function(e){a.logout(e),"/"==t.$$path?r.reload():t.path("/")}}]),adsApp.directive("categories",function(){return{controller:"RightSidebarCtrl",restrict:"E",templateUrl:"templates/directives/categories.html",replace:!0}}),adsApp.directive("loggedInSidebar",function(){return{controller:"HomeCtrl",restrict:"E",templateUrl:"templates/directives/logged-in-sidebar.html",replace:!0}}),adsApp.directive("manageAdMenu",function(){return{controller:"ManageAdMenuCtrl",restrict:"E",templateUrl:"templates/directives/manage-ad-menu.html",replace:!0}}),adsApp.directive("navigation",function(){return{restrict:"E",templateUrl:"templates/directives/navigation.html",replace:!0}}),adsApp.directive("publicAds",function(){return{controller:"PublicAdsCtrl",restrict:"E",templateUrl:"templates/directives/public-ads.html",replace:!0}}),adsApp.directive("publicLeftSidebar",function(){return{controller:"HomeCtrl",restrict:"E",templateUrl:"templates/directives/left-sidebar.html",replace:!0}}),adsApp.directive("statusFilter",function(){return{controller:"StatusFilterCtrl",restrict:"E",templateUrl:"templates/directives/status-filter.html",replace:!0}}),adsApp.directive("towns",function(){return{controller:"RightSidebarCtrl",restrict:"E",templateUrl:"templates/directives/towns.html",replace:!0}}),adsApp.directive("userAds",function(){return{controller:"UserAdsCtrl",restrict:"E",templateUrl:"templates/directives/user-ads.html",replace:!0}}),adsApp.factory("authentication",["localStorageService",function(e){function t(t){e.set(s,t)}function r(){return e.get(s)}function a(){localStorage.removeItem("ls.user")}function o(){var e={},t=r();return t&&(e.Authorization="Bearer "+t.access_token),e}function n(){return r().isAdmin}function i(){return!!r()}var s="user";return{saveUser:t,getUserData:r,removeUser:a,getHeaders:o,isAdmin:n,isLoggedIn:i}}]),adsApp.factory("notification",function(){return{showInfo:function(e){noty({text:e,type:"info",layout:"topCenter",timeout:1e3})},showError:function(e,t){var r=[];if(t&&t.data.error_description&&r.push(t.data.error_description),t&&t.data.modelState){var a=t.data.modelState;for(var o in a)for(var n=a[o],i=o.substr(o.indexOf(".")+1),s=0;s<n.length;s++){var d=n[s];r.push(i+" - "+d)}}r.length>0&&(e=e+":<br>"+r.join("<br>")),noty({text:e,type:"error",layout:"topCenter",timeout:5e3})}}}),adsApp.factory("adsData",["$resource","authentication","baseServiceUrl",function(e,t,r){function a(e){return i.save(e)}function o(e){return i.getAll(e)}function n(e,t){return i.update({id:e},t)}var i=e(r+"ads/:adId",{adId:"@id"},{update:{method:"PUT"},getAll:{method:"GET"}});return{add:a,getPublicAds:o,edit:n}}]),adsApp.factory("categoriesData",["$resource","baseServiceUrl",function(e,t){function r(){return a.query()}var a=e(t+"categories");return{getCategories:r}}]),adsApp.factory("townsData",["$resource","baseServiceUrl",function(e,t){function r(){return a.query()}var a=e(t+"towns");return{getTowns:r}}]),adsApp.factory("userAdsData",["$resource","authentication","baseServiceUrl",function(e,t,r){function a(e){return c.save(e)}function o(e){return c.getAll(e)}function n(e){return c.get({adId:e})}function i(e,t){return c.update({adId:e},t)}function s(a){var o=e(r+"user/ads/deactivate/:adId",{adId:"@id"},{update:{method:"PUT",headers:t.getHeaders()}});return o.update({id:a})}function d(a){var o=e(r+"user/ads/publishagain/:adId",{adId:"@id"},{update:{method:"PUT",headers:t.getHeaders()}});return o.update({id:a})}function l(e){return c.remove({adId:e})}var c=e(r+"user/ads/:adId",{adId:"@id"},{update:{method:"PUT",headers:t.getHeaders()},getAll:{method:"GET",headers:t.getHeaders()},get:{method:"GET",headers:t.getHeaders()},remove:{method:"DELETE",headers:t.getHeaders()},save:{method:"POST",headers:t.getHeaders()}});return{add:a,getUserAds:o,getAdById:n,edit:i,deactivate:s,publishAgain:d,"delete":l}}]),adsApp.factory("userData",["$http","$resource","baseServiceUrl","authentication",function(e,t,r,a){function o(){var e=t(c+"profile",{},{get:{method:"GET",headers:a.getHeaders()}});return e.get()}function n(e){return t(c+"register").save(e)}function i(e){var r=t(c+"login").save(e);return r.$promise.then(function(e){a.saveUser(e)}),r}function s(e){var r=t(c+"profile",{},{update:{method:"PUT",headers:a.getHeaders()}});return r.update(e)}function d(e){var r=t(c+"changePassword",{},{update:{method:"PUT",headers:a.getHeaders()}});return r.update(e)}function l(){a.removeUser()}var c=r+"user/";return{getUserProfile:o,register:n,login:i,edit:s,changePassword:d,logout:l}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL0RlbGV0ZUFkQ3RybC5qcyIsImNvbnRyb2xsZXJzL0VkaXRBZEN0cmwuanMiLCJjb250cm9sbGVycy9FZGl0UHJvZmlsZUN0cmwuanMiLCJjb250cm9sbGVycy9Ib21lQ3RybC5qcyIsImNvbnRyb2xsZXJzL0xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL01hbmFnZUFkTWVudUN0cmwuanMiLCJjb250cm9sbGVycy9QdWJsaWNBZHNDdHJsLmpzIiwiY29udHJvbGxlcnMvUHVibGlzaE5ld0FkQ3RybC5qcyIsImNvbnRyb2xsZXJzL1JlZ2lzdGVyQ3RybC5qcyIsImNvbnRyb2xsZXJzL1JpZ2h0U2lkZWJhckN0cmwuanMiLCJjb250cm9sbGVycy9TdGF0dXNGaWx0ZXJDdHJsLmpzIiwiY29udHJvbGxlcnMvVXNlckFkc0N0cmwuanMiLCJjb250cm9sbGVycy9Vc2VySG9tZUN0cmwuanMiLCJkaXJlY3RpdmVzL2NhdGVnb3JpZXMuanMiLCJkaXJlY3RpdmVzL2xvZ2dlZC1pbi1zaWRlYmFyLmpzIiwiZGlyZWN0aXZlcy9tYW5hZ2UtYWQtbWVudS5qcyIsImRpcmVjdGl2ZXMvbmF2aWdhdGlvbi5qcyIsImRpcmVjdGl2ZXMvcHVibGljLWFkcy5qcyIsImRpcmVjdGl2ZXMvcHVibGljLWxlZnQtc2lkZWJhci5qcyIsImRpcmVjdGl2ZXMvc3RhdHVzLWZpbHRlci5qcyIsImRpcmVjdGl2ZXMvdG93bnMuanMiLCJkaXJlY3RpdmVzL3VzZXItYWRzLmpzIiwic2VydmljZXMvYXV0aGVudGljYXRpb24uanMiLCJzZXJ2aWNlcy9ub3RpZmljYXRpb24uanMiLCJzZXJ2aWNlcy9kYXRhL2Fkc0RhdGEuanMiLCJzZXJ2aWNlcy9kYXRhL2NhdGVnb3JpZXNEYXRhLmpzIiwic2VydmljZXMvZGF0YS90b3duc0RhdGEuanMiLCJzZXJ2aWNlcy9kYXRhL3VzZXJBZHNEYXRhLmpzIiwic2VydmljZXMvZGF0YS91c2VyRGF0YS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLElBQUEsUUFBQSxRQUFBLE9BQUEsVUFDQSxVQUNBLGFBQ0EscUJBQ0EsbUJBQ0EsNEJBR0EsUUFDQSxpQkFDQSw4QkFDQSxTQUFBLEVBQUEsR0FDQSxFQUFBLEtBQUEsS0FDQSxNQUFBLE9BQ0EsWUFBQSxzQkFDQSxXQUFBLGFBR0EsRUFBQSxLQUFBLFVBQ0EsTUFBQSxRQUNBLFlBQUEsdUJBQ0EsV0FBQSxjQUdBLEVBQUEsS0FBQSxhQUNBLE1BQUEsV0FDQSxZQUFBLDBCQUNBLFdBQUEsaUJBR0EsRUFBQSxLQUFBLGNBQ0EsTUFBQSxPQUNBLFlBQUEsMkJBQ0EsV0FBQSxpQkFHQSxFQUFBLEtBQUEsYUFDQSxNQUFBLFNBQ0EsWUFBQSwyQkFDQSxXQUFBLGdCQUdBLEVBQUEsS0FBQSxxQkFDQSxNQUFBLGlCQUNBLFlBQUEsZ0NBQ0EsV0FBQSxxQkFHQSxFQUFBLEtBQUEsc0JBQ0EsTUFBQSxVQUNBLFlBQUEseUJBQ0EsV0FBQSxlQUdBLEVBQUEsS0FBQSx3QkFDQSxNQUFBLFlBQ0EsWUFBQSwyQkFDQSxXQUFBLGlCQUdBLEVBQUEsS0FBQSxpQkFDQSxNQUFBLG9CQUNBLFlBQUEsOEJBQ0EsV0FBQSxvQkFHQSxFQUFBLFdBQUEsV0FBQSxNQUdBLEVBQUEsZUFBQSxrQkFHQSxRQUFBLFNBQUEsaUJBQUEsNkNBQ0EsT0FBQSxTQUFBLFdBQUEsR0FFQSxPQUFBLEtBQUEsYUFBQSxZQUFBLGlCQUFBLFNBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxJQUFBLHNCQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsTUFBQSxFQUFBLFFBQUEsUUFHQSxFQUFBLElBQUEsdUJBQUEsV0FDQSxJQUFBLEVBQUEsT0FBQSxRQUFBLFdBQUEsRUFBQSxjQUVBLEVBQUEsS0FBQSxVQ3BGQSxPQUFBLFdBQUEsZ0JBQ0EsU0FDQSxZQUNBLGVBQ0EsY0FDQSxlQUNBLFNBQUEsRUFBQSxFQUFBLEVBQ0EsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLEVBRUEsR0FBQSxVQUFBLEdBQ0EsU0FDQSxLQUNBLFNBQUEsR0FDQSxFQUFBLEdBQUEsR0FFQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLG1DQUFBLEtBSUEsRUFBQSxPQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsR0FDQSxTQUNBLEtBQ0EsV0FDQSxFQUFBLFNBQUEseUJBQ0EsRUFBQSxLQUFBLGNBRUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxtQ0FBQSxTQy9CQSxPQUFBLFdBQUEsY0FDQSxTQUNBLGVBQ0EsWUFDQSxZQUNBLGlCQUNBLGNBQ0EsZUFDQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFDQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsR0FDQSxHQUFBLENBRUEsR0FBQSxVQUFBLEdBQ0EsU0FDQSxLQUNBLFNBQUEsR0FDQSxFQUFBLE9BQUEsR0FFQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLGtDQUFBLEtBSUEsRUFBQSxXQUFBLEVBQUEsZ0JBQ0EsRUFBQSxNQUFBLEVBQUEsV0FFQSxFQUFBLFlBQUEsaUJBQ0EsR0FBQSxPQUFBLGFBQ0EsR0FBQSxHQUdBLEVBQUEsYUFBQSxTQUFBLFNBQ0EsR0FBQSxPQUFBLFlBQ0EsSUFBQSxHQUFBLEVBQUEsTUFBQSxFQUNBLElBQUEsRUFBQSxLQUFBLE1BQUEsYUFBQSxDQUNBLEdBQUEsR0FBQSxHQUFBLFdBQ0EsR0FBQSxPQUFBLFdBQ0EsRUFBQSxPQUFBLGFBQUEsRUFBQSxPQUNBLEdBQUEsRUFDQSxFQUFBLGNBQUEsS0FBQSxhQUFBLEVBQUEsT0FBQSxPQUdBLEVBQUEsY0FBQSxPQUVBLEdBQUEsY0FBQSxLQUFBLG9DQUtBLEVBQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxZQUFBLEVBRUEsRUFBQSxLQUFBLEVBQUEsR0FDQSxTQUNBLEtBQ0EsV0FDQSxFQUFBLFNBQ0EsbUVBQ0EsRUFBQSxLQUFBLGNBRUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxpQkFBQSxTQy9EQSxPQUFBLFdBQUEsbUJBQ0EsU0FDQSxZQUNBLFlBQ0EsV0FDQSxlQUNBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsTUFDQSxZQUFBLEtBQ0EsWUFBQSxLQUNBLGdCQUFBLE1BR0EsRUFBQSxXQUNBLFNBQ0EsS0FBQSxTQUFBLEdBQ0EsRUFBQSxNQUFBLElBR0EsRUFBQSxpQkFDQSxTQUNBLEtBQ0EsU0FBQSxHQUNBLEVBQUEsS0FBQSxJQUlBLEVBQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxLQUFBLEdBQ0EsU0FDQSxLQUNBLFdBQ0EsRUFBQSxTQUFBLHNDQUNBLEVBQUEsS0FBQSxjQUVBLFNBQUEsR0FDQSxFQUFBLFVBQUEsK0JBQUEsTUFLQSxFQUFBLGVBQUEsU0FBQSxHQUNBLEVBQUEsZUFBQSxHQUNBLFNBQ0EsS0FDQSxXQUNBLEVBQUEsU0FBQSxrQ0FDQSxFQUFBLEtBQUEsY0FFQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLDJCQUFBLFNDckRBLE9BQUEsV0FBQSxZQUNBLFNBQ0EsWUFDQSxTQUNBLFdBQ0EsaUJBQ0EsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxlQUFBLEVBQ0EsRUFBQSxXQUFBLEVBQUEsYUFFQSxFQUFBLE9BQUEsU0FBQSxHQUNBLEVBQUEsT0FBQSxHQUVBLEtBQUEsRUFBQSxPQUNBLEVBQUEsU0FFQSxFQUFBLEtBQUEsU0NqQkEsT0FBQSxXQUFBLGFBQ0EsU0FDQSxZQUNBLFdBQ0EsZUFDQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxNQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsR0FDQSxTQUNBLEtBQUEsV0FDQSxFQUFBLFNBQUEsb0JBQ0EsRUFBQSxLQUFBLGVBQ0EsU0FBQSxHQUNBLEVBQUEsVUFBQSxnQkFBQSxTQ2RBLE9BQUEsV0FBQSxvQkFDQSxTQUNBLFNBQ0EsY0FDQSxlQUNBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FFQSxFQUFBLFdBQUEsU0FBQSxHQUNBLEVBQUEsV0FBQSxHQUNBLFNBQ0EsS0FBQSxXQUNBLEVBQUEsU0FBQSxxQkFDQSxFQUFBLFVBQ0EsU0FBQSxHQUNBLEVBQUEsVUFBQSwwQkFBQSxNQUlBLEVBQUEsYUFBQSxTQUFBLEdBQ0EsRUFBQSxhQUFBLEdBQ0EsU0FDQSxLQUFBLFdBQ0EsRUFBQSxTQUFBLHVDQUNBLEVBQUEsVUFDQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLHVCQUFBLFNDekJBLE9BQUEsV0FBQSxpQkFDQSxTQUNBLFVBQ0EsV0FDQSxlQUNBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FFQSxFQUFBLE9BQUEsRUFDQSxFQUFBLFdBQ0EsVUFBQSxFQUNBLFNBQUEsR0FHQSxFQUFBLFVBQUEsV0FDQSxFQUFBLGFBQUEsRUFBQSxXQUNBLFNBQ0EsS0FDQSxTQUFBLEdBQ0EsRUFBQSxJQUFBLEVBQ0EsRUFBQSxPQUFBLEdBRUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxrQkFBQSxNQUtBLEVBQUEsWUFFQSxFQUFBLElBQUEsMkJBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxVQUFBLFdBQUEsRUFDQSxFQUFBLFVBQUEsVUFBQSxFQUNBLEVBQUEsY0FHQSxFQUFBLElBQUEsdUJBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxVQUFBLE9BQUEsRUFDQSxFQUFBLFVBQUEsVUFBQSxFQUNBLEVBQUEsaUJDcENBLE9BQUEsV0FBQSxvQkFDQSxTQUNBLFlBQ0EsWUFDQSxpQkFDQSxjQUNBLGVBQ0EsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUNBLEVBQUEsR0FDQSxFQUFBLFFBQ0EsT0FBQSxLQUNBLFdBQUEsTUFFQSxFQUFBLFdBQUEsRUFBQSxnQkFDQSxFQUFBLE1BQUEsRUFBQSxXQUVBLEVBQUEsYUFBQSxTQUFBLFNBQ0EsR0FBQSxPQUFBLFlBQ0EsSUFBQSxHQUFBLEVBQUEsTUFBQSxFQUNBLElBQUEsRUFBQSxLQUFBLE1BQUEsYUFBQSxDQUNBLEdBQUEsR0FBQSxHQUFBLFdBQ0EsR0FBQSxPQUFBLFdBQ0EsRUFBQSxPQUFBLGFBQUEsRUFBQSxPQUNBLEVBQUEsY0FBQSxLQUFBLGFBQUEsRUFBQSxPQUFBLE9BRUEsRUFBQSxjQUFBLE9BRUEsR0FBQSxjQUFBLEtBQUEsb0NBS0EsRUFBQSxVQUFBLFNBQUEsR0FDQSxNQUFBLEVBQUEsZUFDQSxFQUFBLGFBQUEsSUFHQSxFQUFBLElBQUEsR0FDQSxTQUNBLEtBQ0EsV0FDQSxFQUFBLFNBQ0EsOEVBQ0EsRUFBQSxLQUFBLGNBRUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxvQkFBQSxTQ2hEQSxPQUFBLFdBQUEsZ0JBQ0EsU0FDQSxZQUNBLFlBQ0EsV0FDQSxlQUNBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsV0FDQSxTQUNBLEtBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxJQUdBLEVBQUEsU0FBQSxTQUFBLEdBQ0EsRUFBQSxTQUFBLEdBQ0EsU0FDQSxLQUFBLFdBQ0EsRUFBQSxTQUFBLHdDQUNBLEVBQUEsS0FBQSxXQUNBLFNBQUEsR0FDQSxFQUFBLFVBQUEsdUJBQUEsU0NyQkEsT0FBQSxXQUFBLG9CQUNBLFNBQ0EsYUFDQSxZQUNBLGlCQUNBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLFdBQUEsRUFBQSxnQkFDQSxFQUFBLE1BQUEsRUFBQSxXQUVBLEVBQUEsZ0JBQUEsU0FBQSxHQUNBLEVBQUEsbUJBQUEsRUFDQSxFQUFBLFdBQUEsMkJBQUEsSUFHQSxFQUFBLFlBQUEsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUNBLEVBQUEsV0FBQSx1QkFBQSxPQ2hCQSxPQUFBLFdBQUEsb0JBQ0EsU0FDQSxhQUNBLFNBQUEsRUFBQSxHQUVBLEVBQUEsY0FBQSxTQUFBLEdBQ0EsRUFBQSxpQkFBQSxFQUNBLEVBQUEsV0FBQSx5QkFBQSxPQ1BBLE9BQUEsV0FBQSxlQUNBLFNBQ0EsU0FDQSxVQUNBLGNBQ0EsV0FDQSxXQUNBLGVBQ0EsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsU0FBQSxFQUNBLEVBQUEsT0FBQSxFQUNBLEVBQUEsV0FDQSxVQUFBLEVBQ0EsU0FBQSxHQUdBLEVBQUEsVUFBQSxXQUNBLEVBQUEsV0FBQSxFQUFBLFdBQ0EsU0FDQSxLQUNBLFNBQUEsR0FDQSxFQUFBLElBQUEsRUFDQSxFQUFBLE9BQUEsRUFFQSxFQUFBLGVBQ0EsU0FBQSxHQUNBLEVBQUEsVUFBQSxLQUlBLFNBQUEsR0FDQSxFQUFBLFVBQUEsa0JBQUEsTUFLQSxFQUFBLFlBRUEsRUFBQSxJQUFBLDJCQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsVUFBQSxXQUFBLEVBQ0EsRUFBQSxVQUFBLFVBQUEsRUFDQSxFQUFBLGNBR0EsRUFBQSxJQUFBLHVCQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsVUFBQSxPQUFBLEVBQ0EsRUFBQSxVQUFBLFVBQUEsRUFDQSxFQUFBLGNBR0EsRUFBQSxJQUFBLHlCQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsVUFBQSxPQUFBLEVBQ0EsRUFBQSxVQUFBLFVBQUEsRUFDQSxFQUFBLGlCQ3REQSxPQUFBLFdBQUEsZ0JBQ0EsU0FDQSxZQUNBLFNBQ0EsV0FDQSxpQkFDQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FFQSxFQUFBLGVBQUEsRUFDQSxFQUFBLFdBQUEsRUFBQSxhQUNBLEVBQUEsT0FBQSxjQUFBLEVBQUEsT0FDQSxFQUFBLFFBQUEsYUFBQSxFQUFBLE9BQ0EsRUFBQSxhQUFBLHFCQUFBLEVBQUEsT0FFQSxFQUFBLE9BQUEsU0FBQSxHQUNBLEVBQUEsT0FBQSxHQUVBLEtBQUEsRUFBQSxPQUNBLEVBQUEsU0FFQSxFQUFBLEtBQUEsU0NwQkEsT0FBQSxVQUFBLGFBQUEsV0FDQSxPQUNBLFdBQUEsbUJBQ0EsU0FBQSxJQUNBLFlBQUEsdUNBQ0EsU0FBQSxLQ0xBLE9BQUEsVUFBQSxrQkFBQSxXQUNBLE9BQ0EsV0FBQSxXQUNBLFNBQUEsSUFDQSxZQUFBLDhDQUNBLFNBQUEsS0NMQSxPQUFBLFVBQUEsZUFBQSxXQUNBLE9BQ0EsV0FBQSxtQkFDQSxTQUFBLElBQ0EsWUFBQSwyQ0FDQSxTQUFBLEtDTEEsT0FBQSxVQUFBLGFBQUEsV0FDQSxPQUNBLFNBQUEsSUFDQSxZQUFBLHVDQUNBLFNBQUEsS0NKQSxPQUFBLFVBQUEsWUFBQSxXQUNBLE9BQ0EsV0FBQSxnQkFDQSxTQUFBLElBQ0EsWUFBQSx1Q0FDQSxTQUFBLEtDTEEsT0FBQSxVQUFBLG9CQUFBLFdBQ0EsT0FDQSxXQUFBLFdBQ0EsU0FBQSxJQUNBLFlBQUEseUNBQ0EsU0FBQSxLQ0xBLE9BQUEsVUFBQSxlQUFBLFdBQ0EsT0FDQSxXQUFBLG1CQUNBLFNBQUEsSUFDQSxZQUFBLDBDQUNBLFNBQUEsS0NMQSxPQUFBLFVBQUEsUUFBQSxXQUNBLE9BQ0EsV0FBQSxtQkFDQSxTQUFBLElBQ0EsWUFBQSxrQ0FDQSxTQUFBLEtDTEEsT0FBQSxVQUFBLFVBQUEsV0FDQSxPQUNBLFdBQUEsY0FDQSxTQUFBLElBQ0EsWUFBQSxxQ0FDQSxTQUFBLEtDTEEsT0FBQSxRQUFBLGtCQUNBLHNCQUNBLFNBQUEsR0FHQSxRQUFBLEdBQUEsR0FDQSxFQUFBLElBQUEsRUFBQSxHQUdBLFFBQUEsS0FDQSxNQUFBLEdBQUEsSUFBQSxHQUdBLFFBQUEsS0FDQSxhQUFBLFdBQUEsV0FHQSxRQUFBLEtBQ0EsR0FBQSxNQUNBLEVBQUEsR0FNQSxPQUpBLEtBQ0EsRUFBQSxjQUFBLFVBQUEsRUFBQSxjQUdBLEVBR0EsUUFBQSxLQUNBLE1BQUEsS0FBQSxRQUdBLFFBQUEsS0FDQSxRQUFBLElBOUJBLEdBQUEsR0FBQSxNQWlDQSxRQUNBLFNBQUEsRUFDQSxZQUFBLEVBQ0EsV0FBQSxFQUNBLFdBQUEsRUFDQSxRQUFBLEVBQ0EsV0FBQSxNQ3hDQSxPQUFBLFFBQUEsZUFDQSxXQUNBLE9BQ0EsU0FBQSxTQUFBLEdBQ0EsTUFDQSxLQUFBLEVBQ0EsS0FBQSxPQUNBLE9BQUEsWUFDQSxRQUFBLE9BSUEsVUFBQSxTQUFBLEVBQUEsR0FFQSxHQUFBLEtBSUEsSUFIQSxHQUFBLEVBQUEsS0FBQSxtQkFDQSxFQUFBLEtBQUEsRUFBQSxLQUFBLG1CQUVBLEdBQUEsRUFBQSxLQUFBLFdBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxLQUFBLFVBQ0EsS0FBQSxHQUFBLEtBQUEsR0FJQSxJQUFBLEdBSEEsR0FBQSxFQUFBLEdBQ0EsRUFDQSxFQUFBLE9BQUEsRUFBQSxRQUFBLEtBQUEsR0FDQSxFQUFBLEVBQUEsRUFBQSxFQUFBLE9BQUEsSUFBQSxDQUNBLEdBQUEsR0FBQSxFQUFBLEVBQ0EsR0FBQSxLQUFBLEVBQUEsTUFBQSxJQUlBLEVBQUEsT0FBQSxJQUNBLEVBQUEsRUFBQSxRQUFBLEVBQUEsS0FBQSxTQUVBLE1BQ0EsS0FBQSxFQUNBLEtBQUEsUUFDQSxPQUFBLFlBQ0EsUUFBQSxVQ3ZDQSxPQUFBLFFBQUEsV0FDQSxZQUNBLGlCQUNBLGlCQUNBLFNBQUEsRUFBQSxFQUFBLEdBTUEsUUFBQSxHQUFBLEdBQ0EsTUFBQSxHQUFBLEtBQUEsR0FHQSxRQUFBLEdBQUEsR0FDQSxNQUFBLEdBQUEsT0FBQSxHQUdBLFFBQUEsR0FBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsR0FBQSxHQUFBLEdBZEEsR0FBQSxHQUFBLEVBQUEsRUFBQSxhQUFBLEtBQUEsUUFDQSxRQUFBLE9BQUEsT0FDQSxRQUFBLE9BQUEsUUFlQSxRQUNBLElBQUEsRUFDQSxhQUFBLEVBQ0EsS0FBQSxNQ3pCQSxPQUFBLFFBQUEsa0JBQUEsWUFBQSxpQkFBQSxTQUFBLEVBQUEsR0FHQSxRQUFBLEtBQ0EsTUFBQSxHQUFBLFFBSEEsR0FBQSxHQUFBLEVBQUEsRUFBQSxhQU1BLFFBQ0EsY0FBQSxNQ1JBLE9BQUEsUUFBQSxhQUFBLFlBQUEsaUJBQUEsU0FBQSxFQUFBLEdBR0EsUUFBQSxLQUNBLE1BQUEsR0FBQSxRQUhBLEdBQUEsR0FBQSxFQUFBLEVBQUEsUUFNQSxRQUNBLFNBQUEsTUNSQSxPQUFBLFFBQUEsZUFDQSxZQUNBLGlCQUNBLGlCQUNBLFNBQUEsRUFBQSxFQUFBLEdBd0JBLFFBQUEsR0FBQSxHQUNBLE1BQUEsR0FBQSxLQUFBLEdBR0EsUUFBQSxHQUFBLEdBQ0EsTUFBQSxHQUFBLE9BQUEsR0FHQSxRQUFBLEdBQUEsR0FDQSxNQUFBLEdBQUEsS0FBQSxLQUFBLElBR0EsUUFBQSxHQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxLQUFBLEdBQUEsR0FHQSxRQUFBLEdBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxFQUFBLDZCQUFBLEtBQUEsUUFDQSxRQUNBLE9BQUEsTUFDQSxRQUFBLEVBQUEsZUFJQSxPQUFBLEdBQUEsUUFBQSxHQUFBLElBR0EsUUFBQSxHQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsRUFBQSwrQkFBQSxLQUFBLFFBQ0EsUUFDQSxPQUFBLE1BQ0EsUUFBQSxFQUFBLGVBSUEsT0FBQSxHQUFBLFFBQUEsR0FBQSxJQUdBLFFBQUEsR0FBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLEtBQUEsSUE5REEsR0FBQSxHQUFBLEVBQUEsRUFBQSxrQkFBQSxLQUFBLFFBQ0EsUUFDQSxPQUFBLE1BQ0EsUUFBQSxFQUFBLGNBRUEsUUFDQSxPQUFBLE1BQ0EsUUFBQSxFQUFBLGNBRUEsS0FDQSxPQUFBLE1BQ0EsUUFBQSxFQUFBLGNBRUEsUUFDQSxPQUFBLFNBQ0EsUUFBQSxFQUFBLGNBRUEsTUFDQSxPQUFBLE9BQ0EsUUFBQSxFQUFBLGVBOENBLFFBQ0EsSUFBQSxFQUNBLFdBQUEsRUFDQSxVQUFBLEVBQ0EsS0FBQSxFQUNBLFdBQUEsRUFDQSxhQUFBLEVBQ0EsU0FBQSxNQzdFQSxPQUFBLFFBQUEsWUFDQSxRQUNBLFlBQ0EsaUJBQ0EsaUJBQ0EsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUlBLFFBQUEsS0FDQSxHQUFBLEdBQUEsRUFBQSxFQUFBLGNBQ0EsS0FDQSxPQUFBLE1BQ0EsUUFBQSxFQUFBLGVBSUEsT0FBQSxHQUFBLE1BR0EsUUFBQSxHQUFBLEdBQ0EsTUFBQSxHQUFBLEVBQUEsWUFDQSxLQUFBLEdBR0EsUUFBQSxHQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsRUFBQSxTQUNBLEtBQUEsRUFPQSxPQUxBLEdBQUEsU0FDQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFNBQUEsS0FHQSxFQUdBLFFBQUEsR0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLEVBQUEsY0FDQSxRQUNBLE9BQUEsTUFDQSxRQUFBLEVBQUEsZUFJQSxPQUFBLEdBQUEsT0FBQSxHQUdBLFFBQUEsR0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLEVBQUEscUJBQ0EsUUFDQSxPQUFBLE1BQ0EsUUFBQSxFQUFBLGVBSUEsT0FBQSxHQUFBLE9BQUEsR0FHQSxRQUFBLEtBQ0EsRUFBQSxhQXJEQSxHQUFBLEdBQUEsRUFBQSxPQXdEQSxRQUNBLGVBQUEsRUFDQSxTQUFBLEVBQ0EsTUFBQSxFQUNBLEtBQUEsRUFDQSxlQUFBLEVBQ0EsT0FBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG52YXIgYWRzQXBwID0gYW5ndWxhci5tb2R1bGUoJ2Fkc0FwcCcsIFtcclxuICAgICduZ1JvdXRlJyxcclxuICAgICduZ1Jlc291cmNlJyxcclxuICAgICdMb2NhbFN0b3JhZ2VNb2R1bGUnLFxyXG4gICAgJ3ZhbGlkYXRpb24ubWF0Y2gnLFxyXG4gICAgJ3VpLmJvb3RzdHJhcC5wYWdpbmF0aW9uJ1xyXG5dKVxyXG5cclxuICAgIC5jb25maWcoW1xyXG4gICAgICAgICckcm91dGVQcm92aWRlcicsXHJcbiAgICAgICAgJ2xvY2FsU3RvcmFnZVNlcnZpY2VQcm92aWRlcicsXHJcbiAgICAgICAgZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyLCBsb2NhbFN0b3JhZ2VTZXJ2aWNlUHJvdmlkZXIpIHtcclxuICAgICAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnSG9tZScsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9ob21lLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsJ1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy9sb2dpbicsIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnTG9naW4nLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbG9naW4uaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJ1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy9yZWdpc3RlcicsIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnUmVnaXN0ZXInLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvcmVnaXN0ZXIuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJ1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy91c2VyL2hvbWUnLCB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJ0hvbWUnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdXNlci1ob21lLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZXJIb21lQ3RybCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkcm91dGVQcm92aWRlci53aGVuKCcvdXNlci9hZHMnLCB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJ015IGFkcycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy91c2VyLWhvbWUuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVXNlckFkc0N0cmwnXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL3VzZXIvYWRzL3B1Ymxpc2gnLCB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1B1Ymxpc2ggbmV3IGFkJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3B1Ymxpc2gtbmV3LWFkLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1B1Ymxpc2hOZXdBZEN0cmwnXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL3VzZXIvYWRzL2VkaXQvOmlkJywge1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdFZGl0IGFkJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2VkaXQtYWQuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRWRpdEFkQ3RybCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkcm91dGVQcm92aWRlci53aGVuKCcvdXNlci9hZHMvZGVsZXRlLzppZCcsIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnRGVsZXRlIGFkJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2RlbGV0ZS1hZC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEZWxldGVBZEN0cmwnXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL3VzZXIvcHJvZmlsZScsIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnRWRpdCB1c2VyIHByb2ZpbGUnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvZWRpdC1wcm9maWxlLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0VkaXRQcm9maWxlQ3RybCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkcm91dGVQcm92aWRlci5vdGhlcndpc2Uoe3JlZGlyZWN0VG86ICcvJ30pO1xyXG5cclxuICAgICAgICAgICAgLy8gV2ViIHN0b3JhZ2Ugc2V0dGluZ3NcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlU2VydmljZVByb3ZpZGVyLnNldFN0b3JhZ2VUeXBlKCdsb2NhbFN0b3JhZ2UnKTtcclxuICAgICAgICB9XSk7XHJcblxyXG5hZHNBcHAuY29uc3RhbnQoJ2Jhc2VTZXJ2aWNlVXJsJywgJ2h0dHA6Ly9zb2Z0dW5pLWFkcy5henVyZXdlYnNpdGVzLm5ldC9hcGkvJyk7XHJcbmFkc0FwcC5jb25zdGFudCgncGFnZVNpemUnLCA1KTtcclxuXHJcbmFkc0FwcC5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUsICRsb2NhdGlvbiwgYXV0aGVudGljYXRpb24pIHtcclxuXHJcbiAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uIChldmVudCwgY3VycmVudCwgcHJldmlvdXMpIHtcclxuICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gY3VycmVudC4kJHJvdXRlLnRpdGxlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHJvb3RTY29wZS4kb24oJyRsb2NhdGlvbkNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICgkbG9jYXRpb24ucGF0aCgpLmluZGV4T2YoJy91c2VyLycpICE9IC0xICYmICFhdXRoZW50aWNhdGlvbi5pc0xvZ2dlZEluKCkpIHtcclxuICAgICAgICAgICAgLy8gQXV0aG9yaXphdGlvbiBjaGVjazogYW5vbnltb3VzIHNpdGUgdmlzaXRvcnMgY2Fubm90IGFjY2VzcyB1c2VyIHJvdXRlc1xyXG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYWRzQXBwLmNvbnRyb2xsZXIoJ0RlbGV0ZUFkQ3RybCcsIFtcclxuICAgICckc2NvcGUnLFxyXG4gICAgJyRsb2NhdGlvbicsXHJcbiAgICAnJHJvdXRlUGFyYW1zJyxcclxuICAgICd1c2VyQWRzRGF0YScsXHJcbiAgICAnbm90aWZpY2F0aW9uJyxcclxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgJHJvdXRlUGFyYW1zLFxyXG4gICAgICAgICAgICAgIHVzZXJBZHNEYXRhLCBub3RpZmljYXRpb24pIHtcclxuXHJcbiAgICAgICAgdmFyIGFkSWQgPSAkcm91dGVQYXJhbXMuaWQ7XHJcblxyXG4gICAgICAgIHVzZXJBZHNEYXRhLmdldEFkQnlJZChhZElkKVxyXG4gICAgICAgICAgICAuJHByb21pc2VcclxuICAgICAgICAgICAgLnRoZW4oXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkID0gZGF0YTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3IoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0Vycm9yKCdBZHZlcnRpc2VtZW50IGNhbiBub3QgYmUgZGVsZXRlZCcsIGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAkc2NvcGUuZGVsZXRlID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgICAgIHVzZXJBZHNEYXRhLmRlbGV0ZShpZClcclxuICAgICAgICAgICAgICAgIC4kcHJvbWlzZVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0luZm8oJ0FkdmVydGlzZW1lbnQgZGVsZXRlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvdXNlci9hZHMnKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlcnJvcihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0Vycm9yKCdBZHZlcnRpc2VtZW50IGNhbiBub3QgYmUgZGVsZXRlZCcsIGVycik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1dKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYWRzQXBwLmNvbnRyb2xsZXIoJ0VkaXRBZEN0cmwnLCBbXHJcbiAgICAnJHNjb3BlJyxcclxuICAgICckcm91dGVQYXJhbXMnLFxyXG4gICAgJyRsb2NhdGlvbicsXHJcbiAgICAndG93bnNEYXRhJyxcclxuICAgICdjYXRlZ29yaWVzRGF0YScsXHJcbiAgICAndXNlckFkc0RhdGEnLFxyXG4gICAgJ25vdGlmaWNhdGlvbicsXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkcm91dGVQYXJhbXMsICRsb2NhdGlvbiwgdG93bnNEYXRhLCBjYXRlZ29yaWVzRGF0YSxcclxuICAgICAgICAgICAgICB1c2VyQWRzRGF0YSwgbm90aWZpY2F0aW9uKSB7XHJcblxyXG4gICAgICAgIHZhciBhZElkID0gJHJvdXRlUGFyYW1zLmlkO1xyXG4gICAgICAgIHZhciBjaGFuZ2VJbWFnZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB1c2VyQWRzRGF0YS5nZXRBZEJ5SWQoYWRJZClcclxuICAgICAgICAgICAgLiRwcm9taXNlXHJcbiAgICAgICAgICAgIC50aGVuKFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hZERhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBlcnJvcihlcnIpIHtcclxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zaG93RXJyb3IoJ0FkdmVydGlzZW1lbnQgY2FuIG5vdCBiZSBlZGl0ZWQnLCBlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzRGF0YS5nZXRDYXRlZ29yaWVzKCk7XHJcbiAgICAgICAgJHNjb3BlLnRvd25zID0gdG93bnNEYXRhLmdldFRvd25zKCk7XHJcblxyXG4gICAgICAgICRzY29wZS5kZWxldGVJbWFnZSA9IGZ1bmN0aW9uIChhZERhdGEpIHtcclxuICAgICAgICAgICAgZGVsZXRlICRzY29wZS5hZERhdGEuaW1hZ2VEYXRhVXJsO1xyXG4gICAgICAgICAgICBjaGFuZ2VJbWFnZSA9IHRydWU7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmZpbGVTZWxlY3RlZCA9IGZ1bmN0aW9uIChmaWxlSW5wdXRGaWVsZCkge1xyXG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLmFkRGF0YS5pbWFnZURhdGFVcmw7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gZmlsZUlucHV0RmllbGQuZmlsZXNbMF07XHJcbiAgICAgICAgICAgIGlmIChmaWxlLnR5cGUubWF0Y2goL2ltYWdlXFwvLiovKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hZERhdGEuaW1hZ2VEYXRhVXJsID0gcmVhZGVyLnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VJbWFnZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIi5pbWFnZS1ib3hcIikuaHRtbChcIjxpbWcgc3JjPSdcIiArIHJlYWRlci5yZXN1bHQgKyBcIic+XCIpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQoXCIuaW1hZ2UtYm94XCIpLmh0bWwoXCI8cD5GaWxlIHR5cGUgbm90IHN1cHBvcnRlZCE8L3A+XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICRzY29wZS5lZGl0ID0gZnVuY3Rpb24gKGFkRGF0YSkge1xyXG4gICAgICAgICAgICBhZERhdGEuY2hhbmdlSW1hZ2UgPSBjaGFuZ2VJbWFnZTtcclxuXHJcbiAgICAgICAgICAgIHVzZXJBZHNEYXRhLmVkaXQoYWRJZCwgYWREYXRhKVxyXG4gICAgICAgICAgICAgICAgLiRwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAudGhlbihcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dJbmZvKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnQWR2ZXJ0aXNlbWVudCBlZGl0ZWQuIERvblxcJ3QgZm9yZ2V0IHRvIHN1Ym1pdCBpdCBmb3IgcHVibGlzaGluZy4nKTtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3VzZXIvYWRzJyk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3IoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dFcnJvcignRWRpdGluZyBmYWlsZWQnLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XSk7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFkc0FwcC5jb250cm9sbGVyKCdFZGl0UHJvZmlsZUN0cmwnLCBbXHJcbiAgICAnJHNjb3BlJyxcclxuICAgICckbG9jYXRpb24nLFxyXG4gICAgJ3Rvd25zRGF0YScsXHJcbiAgICAndXNlckRhdGEnLFxyXG4gICAgJ25vdGlmaWNhdGlvbicsXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sIHRvd25zRGF0YSwgdXNlckRhdGEsIG5vdGlmaWNhdGlvbikge1xyXG5cclxuICAgICAgICAkc2NvcGUucGFzcyA9IHtcclxuICAgICAgICAgICAgb2xkUGFzc3dvcmQ6IG51bGwsXHJcbiAgICAgICAgICAgIG5ld1Bhc3N3b3JkOiBudWxsLFxyXG4gICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6IG51bGxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0b3duc0RhdGEuZ2V0VG93bnMoKVxyXG4gICAgICAgICAgICAuJHByb21pc2VcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS50b3ducyA9IGRhdGE7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB1c2VyRGF0YS5nZXRVc2VyUHJvZmlsZSgpXHJcbiAgICAgICAgICAgIC4kcHJvbWlzZVxyXG4gICAgICAgICAgICAudGhlbihcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS51c2VyID0gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgICRzY29wZS5lZGl0ID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICAgICAgdXNlckRhdGEuZWRpdCh1c2VyKVxyXG4gICAgICAgICAgICAgICAgLiRwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAudGhlbihcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dJbmZvKCdVc2VyIHByb2ZpbGUgc3VjY2Vzc2Z1bGx5IHVwZGF0ZWQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy91c2VyL2FkcycpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zaG93RXJyb3IoJ1VzZXIgcHJvZmlsZSBpcyBub3QgdXBkYXRlZC4nLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5jaGFuZ2VQYXNzd29yZCA9IGZ1bmN0aW9uIChwYXNzKSB7XHJcbiAgICAgICAgICAgIHVzZXJEYXRhLmNoYW5nZVBhc3N3b3JkKHBhc3MpXHJcbiAgICAgICAgICAgICAgICAuJHByb21pc2VcclxuICAgICAgICAgICAgICAgIC50aGVuKFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc3VjY2VzcygpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0luZm8oJ1Bhc3N3b3JkIHN1Y2Nlc3NmdWxseSB1cGRhdGVkLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvdXNlci9hZHMnKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlcnJvcihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0Vycm9yKCdQYXNzd29yZCBpcyBub3QgdXBkYXRlZC4nLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuIiwiYWRzQXBwLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgW1xyXG4gICAgJyRzY29wZScsXHJcbiAgICAnJGxvY2F0aW9uJyxcclxuICAgICckcm91dGUnLFxyXG4gICAgJ3VzZXJEYXRhJyxcclxuICAgICdhdXRoZW50aWNhdGlvbicsXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sICRyb3V0ZSwgdXNlckRhdGEsIGF1dGhlbnRpY2F0aW9uKSB7XHJcblxyXG4gICAgICAgICRzY29wZS5hdXRoZW50aWNhdGlvbiA9IGF1dGhlbnRpY2F0aW9uO1xyXG4gICAgICAgICRzY29wZS5pc0xvZ2dlZEluID0gYXV0aGVudGljYXRpb24uaXNMb2dnZWRJbigpO1xyXG5cclxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICAgICAgdXNlckRhdGEubG9nb3V0KHVzZXIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRsb2NhdGlvbi4kJHBhdGggPT0gJy8nKSB7XHJcbiAgICAgICAgICAgICAgICAkcm91dGUucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xyXG4iLCJhZHNBcHAuY29udHJvbGxlcignTG9naW5DdHJsJywgW1xyXG4gICAgJyRzY29wZScsXHJcbiAgICAnJGxvY2F0aW9uJyxcclxuICAgICd1c2VyRGF0YScsXHJcbiAgICAnbm90aWZpY2F0aW9uJyxcclxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgdXNlckRhdGEsIG5vdGlmaWNhdGlvbikge1xyXG5cclxuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgICAgICB1c2VyRGF0YS5sb2dpbih1c2VyKVxyXG4gICAgICAgICAgICAgICAgLiRwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dJbmZvKCdMb2dpbiBzdWNjZXNzZnVsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy91c2VyL2hvbWUnKTtcclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zaG93RXJyb3IoJ0ludmFsaWQgbG9naW4nLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XSk7XHJcbiIsImFkc0FwcC5jb250cm9sbGVyKCdNYW5hZ2VBZE1lbnVDdHJsJywgW1xyXG4gICAgJyRzY29wZScsXHJcbiAgICAnJHJvdXRlJyxcclxuICAgICd1c2VyQWRzRGF0YScsXHJcbiAgICAnbm90aWZpY2F0aW9uJyxcclxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRyb3V0ZSwgdXNlckFkc0RhdGEsIG5vdGlmaWNhdGlvbikge1xyXG5cclxuICAgICAgICAkc2NvcGUuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uIChhZElkKSB7XHJcbiAgICAgICAgICAgIHVzZXJBZHNEYXRhLmRlYWN0aXZhdGUoYWRJZClcclxuICAgICAgICAgICAgICAgIC4kcHJvbWlzZVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zaG93SW5mbygnQWQgaXMgZGVhY3RpdmF0ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAkcm91dGUucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0Vycm9yKCdDYW5cXCd0IGRlYWN0aXZhdGUgdGhlIGFkJywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnB1Ymxpc2hBZ2FpbiA9IGZ1bmN0aW9uIChhZElkKSB7XHJcbiAgICAgICAgICAgIHVzZXJBZHNEYXRhLnB1Ymxpc2hBZ2FpbihhZElkKVxyXG4gICAgICAgICAgICAgICAgLiRwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dJbmZvKCdBZCBpcyBwdWJsaXNoZWQgYWdhaW4gZm9yIGFwcHJvdmFsLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb3V0ZS5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zaG93RXJyb3IoJ0NhblxcJ3QgcHVibGlzaCB0aGUgYWQnLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfV0pO1xyXG4iLCJhZHNBcHAuY29udHJvbGxlcignUHVibGljQWRzQ3RybCcsIFtcclxuICAgICckc2NvcGUnLFxyXG4gICAgJ2Fkc0RhdGEnLFxyXG4gICAgJ3BhZ2VTaXplJyxcclxuICAgICdub3RpZmljYXRpb24nLFxyXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgYWRzRGF0YSwgcGFnZVNpemUsIG5vdGlmaWNhdGlvbikge1xyXG5cclxuICAgICAgICAkc2NvcGUucmVhZHkgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuYWRzUGFyYW1zID0ge1xyXG4gICAgICAgICAgICBzdGFydFBhZ2U6IDEsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5yZWxvYWRBZHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGFkc0RhdGEuZ2V0UHVibGljQWRzKCRzY29wZS5hZHNQYXJhbXMpXHJcbiAgICAgICAgICAgICAgICAuJHByb21pc2VcclxuICAgICAgICAgICAgICAgIC50aGVuKFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkcyA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlYWR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlcnJvcihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0Vycm9yKCdDYW5ub3QgbG9hZCBhZHMnLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5yZWxvYWRBZHMoKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignY2F0ZWdvcnlTZWxlY3Rpb25DaGFuZ2VkJywgZnVuY3Rpb24gKGV2ZW50LCBzZWxlY3RlZENhdGVnb3J5SWQpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmFkc1BhcmFtcy5jYXRlZ29yeUlkID0gc2VsZWN0ZWRDYXRlZ29yeUlkO1xyXG4gICAgICAgICAgICAkc2NvcGUuYWRzUGFyYW1zLnN0YXJ0UGFnZSA9IDE7XHJcbiAgICAgICAgICAgICRzY29wZS5yZWxvYWRBZHMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbigndG93blNlbGVjdGlvbkNoYW5nZWQnLCBmdW5jdGlvbiAoZXZlbnQsIHNlbGVjdGVkVG93bklkKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hZHNQYXJhbXMudG93bklkID0gc2VsZWN0ZWRUb3duSWQ7XHJcbiAgICAgICAgICAgICRzY29wZS5hZHNQYXJhbXMuc3RhcnRQYWdlID0gMTtcclxuICAgICAgICAgICAgJHNjb3BlLnJlbG9hZEFkcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfV0pO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG5hZHNBcHAuY29udHJvbGxlcignUHVibGlzaE5ld0FkQ3RybCcsIFtcclxuICAgICckc2NvcGUnLFxyXG4gICAgJyRsb2NhdGlvbicsXHJcbiAgICAndG93bnNEYXRhJyxcclxuICAgICdjYXRlZ29yaWVzRGF0YScsXHJcbiAgICAndXNlckFkc0RhdGEnLFxyXG4gICAgJ25vdGlmaWNhdGlvbicsXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sIHRvd25zRGF0YSwgY2F0ZWdvcmllc0RhdGEsXHJcbiAgICAgICAgICAgICAgdXNlckFkc0RhdGEsIG5vdGlmaWNhdGlvbikge1xyXG4gICAgICAgICRzY29wZS5hZERhdGEgPSB7XHJcbiAgICAgICAgICAgIHRvd25JZDogbnVsbCxcclxuICAgICAgICAgICAgY2F0ZWdvcnlJZDogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzRGF0YS5nZXRDYXRlZ29yaWVzKCk7XHJcbiAgICAgICAgJHNjb3BlLnRvd25zID0gdG93bnNEYXRhLmdldFRvd25zKCk7XHJcblxyXG4gICAgICAgICRzY29wZS5maWxlU2VsZWN0ZWQgPSBmdW5jdGlvbiAoZmlsZUlucHV0RmllbGQpIHtcclxuICAgICAgICAgICAgZGVsZXRlICRzY29wZS5hZERhdGEuaW1hZ2VEYXRhVXJsO1xyXG4gICAgICAgICAgICB2YXIgZmlsZSA9IGZpbGVJbnB1dEZpZWxkLmZpbGVzWzBdO1xyXG4gICAgICAgICAgICBpZiAoZmlsZS50eXBlLm1hdGNoKC9pbWFnZVxcLy4qLykpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWREYXRhLmltYWdlRGF0YVVybCA9IHJlYWRlci5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIi5pbWFnZS1ib3hcIikuaHRtbChcIjxpbWcgc3JjPSdcIiArIHJlYWRlci5yZXN1bHQgKyBcIic+XCIpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJChcIi5pbWFnZS1ib3hcIikuaHRtbChcIjxwPkZpbGUgdHlwZSBub3Qgc3VwcG9ydGVkITwvcD5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgJHNjb3BlLnB1Ymxpc2hBZCA9IGZ1bmN0aW9uIChhZERhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGFkRGF0YS5pbWFnZURhdGFVcmwgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgYWREYXRhLmltYWdlRGF0YVVybCA9ICcnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1c2VyQWRzRGF0YS5hZGQoYWREYXRhKVxyXG4gICAgICAgICAgICAgICAgLiRwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAudGhlbihcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dJbmZvKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnQWR2ZXJ0aXNlbWVudCBzdWJtaXR0ZWQgZG9yIGFwcHJvdmFsLiBPbmNlIGFwcHJvdmVkLCBpdCB3aWxsIGJlIHB1Ymxpc2hlZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3VzZXIvYWRzJyk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3IoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dFcnJvcignUHVibGlzaGluZyBmYWlsZWQnLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuIiwiYWRzQXBwLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIFtcclxuICAgICckc2NvcGUnLFxyXG4gICAgJyRsb2NhdGlvbicsXHJcbiAgICAndG93bnNEYXRhJyxcclxuICAgICd1c2VyRGF0YScsXHJcbiAgICAnbm90aWZpY2F0aW9uJyxcclxuICAgIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgdG93bnNEYXRhLCB1c2VyRGF0YSwgbm90aWZpY2F0aW9uKSB7XHJcblxyXG4gICAgICAgIHRvd25zRGF0YS5nZXRUb3ducygpXHJcbiAgICAgICAgICAgIC4kcHJvbWlzZVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvd25zID0gZGF0YTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgICAgIHVzZXJEYXRhLnJlZ2lzdGVyKHVzZXIpXHJcbiAgICAgICAgICAgICAgICAuJHByb21pc2VcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2hvd0luZm8oJ1VzZXIgYWNjb3VudCBjcmVhdGVkLiBQbGVhc2UgbG9nIGluLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zaG93RXJyb3IoJ0ludmFsaWQgcmVnaXN0cmF0aW9uJywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xyXG4iLCJhZHNBcHAuY29udHJvbGxlcignUmlnaHRTaWRlYmFyQ3RybCcsIFtcclxuICAgICckc2NvcGUnLFxyXG4gICAgJyRyb290U2NvcGUnLFxyXG4gICAgJ3Rvd25zRGF0YScsXHJcbiAgICAnY2F0ZWdvcmllc0RhdGEnLFxyXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgdG93bnNEYXRhLCBjYXRlZ29yaWVzRGF0YSkge1xyXG4gICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gY2F0ZWdvcmllc0RhdGEuZ2V0Q2F0ZWdvcmllcygpO1xyXG4gICAgICAgICRzY29wZS50b3ducyA9IHRvd25zRGF0YS5nZXRUb3ducygpO1xyXG5cclxuICAgICAgICAkc2NvcGUuY2F0ZWdvcnlDbGlja2VkID0gZnVuY3Rpb24gKGNsaWNrZWRDYXRlZ29yeUlkKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZENhdGVnb3J5SWQgPSBjbGlja2VkQ2F0ZWdvcnlJZDtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdjYXRlZ29yeVNlbGVjdGlvbkNoYW5nZWQnLCBjbGlja2VkQ2F0ZWdvcnlJZCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnRvd25DbGlja2VkID0gZnVuY3Rpb24gKGNsaWNrZWRUb3duSWQpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkVG93bklkID0gY2xpY2tlZFRvd25JZDtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd0b3duU2VsZWN0aW9uQ2hhbmdlZCcsIGNsaWNrZWRUb3duSWQpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcbiIsImFkc0FwcC5jb250cm9sbGVyKCdTdGF0dXNGaWx0ZXJDdHJsJywgW1xyXG4gICAgJyRzY29wZScsXHJcbiAgICAnJHJvb3RTY29wZScsXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlKSB7XHJcblxyXG4gICAgICAgICRzY29wZS5zdGF0dXNDbGlja2VkID0gZnVuY3Rpb24gKHNlbGVjdGVkU3RhdHVzSWQpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkU3RhdHVzSWQgPSBzZWxlY3RlZFN0YXR1c0lkO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3N0YXR1c1NlbGVjdGlvbkNoYW5nZWQnLCBzZWxlY3RlZFN0YXR1c0lkKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1dKTtcclxuIiwiYWRzQXBwLmNvbnRyb2xsZXIoJ1VzZXJBZHNDdHJsJywgW1xyXG4gICAgJyRzY29wZScsXHJcbiAgICAnJHJvdXRlJyxcclxuICAgICdhZHNEYXRhJyxcclxuICAgICd1c2VyQWRzRGF0YScsXHJcbiAgICAndXNlckRhdGEnLFxyXG4gICAgJ3BhZ2VTaXplJyxcclxuICAgICdub3RpZmljYXRpb24nLFxyXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJHJvdXRlLCBhZHNEYXRhLCB1c2VyQWRzRGF0YSwgdXNlckRhdGEsIHBhZ2VTaXplLCBub3RpZmljYXRpb24pIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLmluTXlBZHMgPSB0cnVlO1xyXG4gICAgICAgICRzY29wZS5yZWFkeSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5hZHNQYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICdzdGFydFBhZ2UnOiAxLFxyXG4gICAgICAgICAgICAncGFnZVNpemUnOiBwYWdlU2l6ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5yZWxvYWRBZHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHVzZXJBZHNEYXRhLmdldFVzZXJBZHMoJHNjb3BlLmFkc1BhcmFtcylcclxuICAgICAgICAgICAgICAgIC4kcHJvbWlzZVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRzID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZHkgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB1c2VyRGF0YS5nZXRVc2VyUHJvZmlsZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3duZXJEYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3IoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnNob3dFcnJvcignQ2Fubm90IGxvYWQgYWRzJywgZXJyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUucmVsb2FkQWRzKCk7XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2NhdGVnb3J5U2VsZWN0aW9uQ2hhbmdlZCcsIGZ1bmN0aW9uIChldmVudCwgc2VsZWN0ZWRDYXRlZ29yeUlkKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hZHNQYXJhbXMuY2F0ZWdvcnlJZCA9IHNlbGVjdGVkQ2F0ZWdvcnlJZDtcclxuICAgICAgICAgICAgJHNjb3BlLmFkc1BhcmFtcy5zdGFydFBhZ2UgPSAxO1xyXG4gICAgICAgICAgICAkc2NvcGUucmVsb2FkQWRzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ3Rvd25TZWxlY3Rpb25DaGFuZ2VkJywgZnVuY3Rpb24gKGV2ZW50LCBzZWxlY3RlZFRvd25JZCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWRzUGFyYW1zLnRvd25JZCA9IHNlbGVjdGVkVG93bklkO1xyXG4gICAgICAgICAgICAkc2NvcGUuYWRzUGFyYW1zLnN0YXJ0UGFnZSA9IDE7XHJcbiAgICAgICAgICAgICRzY29wZS5yZWxvYWRBZHMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignc3RhdHVzU2VsZWN0aW9uQ2hhbmdlZCcsIGZ1bmN0aW9uIChldmVudCwgc2VsZWN0ZWRTdGF0dXNJZCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWRzUGFyYW1zLnN0YXR1cyA9IHNlbGVjdGVkU3RhdHVzSWQ7XHJcbiAgICAgICAgICAgICRzY29wZS5hZHNQYXJhbXMuc3RhcnRQYWdlID0gMTtcclxuICAgICAgICAgICAgJHNjb3BlLnJlbG9hZEFkcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfV0pO1xyXG4iLCJhZHNBcHAuY29udHJvbGxlcignVXNlckhvbWVDdHJsJywgW1xyXG4gICAgJyRzY29wZScsXHJcbiAgICAnJGxvY2F0aW9uJyxcclxuICAgICckcm91dGUnLFxyXG4gICAgJ3VzZXJEYXRhJyxcclxuICAgICdhdXRoZW50aWNhdGlvbicsXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sICRyb3V0ZSwgdXNlckRhdGEsIGF1dGhlbnRpY2F0aW9uKSB7XHJcblxyXG4gICAgICAgICRzY29wZS5hdXRoZW50aWNhdGlvbiA9IGF1dGhlbnRpY2F0aW9uO1xyXG4gICAgICAgICRzY29wZS5pc0xvZ2dlZEluID0gYXV0aGVudGljYXRpb24uaXNMb2dnZWRJbigpO1xyXG4gICAgICAgICRzY29wZS5pbkhvbWUgPSAkbG9jYXRpb24uJCRwYXRoID09ICcvdXNlci9ob21lJztcclxuICAgICAgICAkc2NvcGUuaW5NeUFkcyA9ICRsb2NhdGlvbi4kJHBhdGggPT0gJy91c2VyL2Fkcyc7XHJcbiAgICAgICAgJHNjb3BlLmluUHVibGlzaE5ldyA9ICRsb2NhdGlvbi4kJHBhdGggPT0gJy91c2VyL2Fkcy9wdWJsaXNoJztcclxuXHJcbiAgICAgICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgICAgIHVzZXJEYXRhLmxvZ291dCh1c2VyKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkbG9jYXRpb24uJCRwYXRoID09ICcvJykge1xyXG4gICAgICAgICAgICAgICAgJHJvdXRlLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuIiwiYWRzQXBwLmRpcmVjdGl2ZSgnY2F0ZWdvcmllcycsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY29udHJvbGxlcjogJ1JpZ2h0U2lkZWJhckN0cmwnLFxyXG4gICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvZGlyZWN0aXZlcy9jYXRlZ29yaWVzLmh0bWwnLFxyXG4gICAgICAgIHJlcGxhY2U6IHRydWVcclxuICAgIH1cclxufSk7XHJcbiIsImFkc0FwcC5kaXJlY3RpdmUoJ2xvZ2dlZEluU2lkZWJhcicsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsJyxcclxuICAgICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2RpcmVjdGl2ZXMvbG9nZ2VkLWluLXNpZGViYXIuaHRtbCcsXHJcbiAgICAgICAgcmVwbGFjZTogdHJ1ZVxyXG4gICAgfVxyXG59KTtcclxuIiwiYWRzQXBwLmRpcmVjdGl2ZSgnbWFuYWdlQWRNZW51JywgZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjb250cm9sbGVyOiAnTWFuYWdlQWRNZW51Q3RybCcsXHJcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9kaXJlY3RpdmVzL21hbmFnZS1hZC1tZW51Lmh0bWwnLFxyXG4gICAgICAgIHJlcGxhY2U6IHRydWVcclxuICAgIH1cclxufSk7XHJcbiIsImFkc0FwcC5kaXJlY3RpdmUoJ25hdmlnYXRpb24nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvZGlyZWN0aXZlcy9uYXZpZ2F0aW9uLmh0bWwnLFxyXG4gICAgICAgIHJlcGxhY2U6IHRydWVcclxuICAgIH1cclxufSk7XHJcbiIsImFkc0FwcC5kaXJlY3RpdmUoJ3B1YmxpY0FkcycsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY29udHJvbGxlcjogJ1B1YmxpY0Fkc0N0cmwnLFxyXG4gICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvZGlyZWN0aXZlcy9wdWJsaWMtYWRzLmh0bWwnLFxyXG4gICAgICAgIHJlcGxhY2U6IHRydWVcclxuICAgIH1cclxufSk7XHJcbiIsImFkc0FwcC5kaXJlY3RpdmUoJ3B1YmxpY0xlZnRTaWRlYmFyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwnLFxyXG4gICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvZGlyZWN0aXZlcy9sZWZ0LXNpZGViYXIuaHRtbCcsXHJcbiAgICAgICAgcmVwbGFjZTogdHJ1ZVxyXG4gICAgfVxyXG59KTtcclxuIiwiYWRzQXBwLmRpcmVjdGl2ZSgnc3RhdHVzRmlsdGVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjb250cm9sbGVyOiAnU3RhdHVzRmlsdGVyQ3RybCcsXHJcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9kaXJlY3RpdmVzL3N0YXR1cy1maWx0ZXIuaHRtbCcsXHJcbiAgICAgICAgcmVwbGFjZTogdHJ1ZVxyXG4gICAgfVxyXG59KTtcclxuIiwiYWRzQXBwLmRpcmVjdGl2ZSgndG93bnMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGNvbnRyb2xsZXI6ICdSaWdodFNpZGViYXJDdHJsJyxcclxuICAgICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2RpcmVjdGl2ZXMvdG93bnMuaHRtbCcsXHJcbiAgICAgICAgcmVwbGFjZTogdHJ1ZVxyXG4gICAgfVxyXG59KTtcclxuIiwiYWRzQXBwLmRpcmVjdGl2ZSgndXNlckFkcycsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY29udHJvbGxlcjogJ1VzZXJBZHNDdHJsJyxcclxuICAgICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2RpcmVjdGl2ZXMvdXNlci1hZHMuaHRtbCcsXHJcbiAgICAgICAgcmVwbGFjZTogdHJ1ZVxyXG4gICAgfVxyXG59KTtcclxuIiwiYWRzQXBwLmZhY3RvcnkoJ2F1dGhlbnRpY2F0aW9uJywgW1xyXG4gICAgJ2xvY2FsU3RvcmFnZVNlcnZpY2UnLFxyXG4gICAgZnVuY3Rpb24gKGxvY2FsU3RvcmFnZVNlcnZpY2UpIHtcclxuICAgICAgICB2YXIga2V5ID0gJ3VzZXInO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBzYXZlVXNlckRhdGEoZGF0YSkge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldChrZXksIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckRhdGEoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldChrZXkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlVXNlcigpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2xzLnVzZXInKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEhlYWRlcnMoKSB7XHJcbiAgICAgICAgICAgIHZhciBoZWFkZXJzID0ge307XHJcbiAgICAgICAgICAgIHZhciB1c2VyRGF0YSA9IGdldFVzZXJEYXRhKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAodXNlckRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIHVzZXJEYXRhLmFjY2Vzc190b2tlbjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGhlYWRlcnM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpc0FkbWluKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0VXNlckRhdGEoKS5pc0FkbWluO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaXNMb2dnZWRJbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEhZ2V0VXNlckRhdGEoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNhdmVVc2VyOiBzYXZlVXNlckRhdGEsXHJcbiAgICAgICAgICAgIGdldFVzZXJEYXRhOiBnZXRVc2VyRGF0YSxcclxuICAgICAgICAgICAgcmVtb3ZlVXNlcjogcmVtb3ZlVXNlcixcclxuICAgICAgICAgICAgZ2V0SGVhZGVyczogZ2V0SGVhZGVycyxcclxuICAgICAgICAgICAgaXNBZG1pbjogaXNBZG1pbixcclxuICAgICAgICAgICAgaXNMb2dnZWRJbjogaXNMb2dnZWRJblxyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYWRzQXBwLmZhY3RvcnkoJ25vdGlmaWNhdGlvbicsXHJcbiAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2hvd0luZm86IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICAgICAgICAgIG5vdHkoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtc2csXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0OiAndG9wQ2VudGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dDogMTAwMFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNob3dFcnJvcjogZnVuY3Rpb24gKG1zZywgc2VydmVyRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIENvbGxlY3QgZXJyb3JzIHRvIGRpc3BsYXkgZnJvbSB0aGUgc2VydmVyIHJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3JzID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VydmVyRXJyb3IgJiYgc2VydmVyRXJyb3IuZGF0YS5lcnJvcl9kZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHNlcnZlckVycm9yLmRhdGEuZXJyb3JfZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNlcnZlckVycm9yICYmIHNlcnZlckVycm9yLmRhdGEubW9kZWxTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtb2RlbFN0YXRlRXJyb3JzID0gc2VydmVyRXJyb3IuZGF0YS5tb2RlbFN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHByb3BlcnR5TmFtZSBpbiBtb2RlbFN0YXRlRXJyb3JzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2VzID0gbW9kZWxTdGF0ZUVycm9yc1twcm9wZXJ0eU5hbWVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJpbW1lZE5hbWUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lLnN1YnN0cihwcm9wZXJ0eU5hbWUuaW5kZXhPZignLicpICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JNZXNzYWdlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRFcnJvciA9IGVycm9yTWVzc2FnZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh0cmltbWVkTmFtZSArICcgLSAnICsgY3VycmVudEVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1zZyA9IG1zZyArIFwiOjxicj5cIiArIGVycm9ycy5qb2luKFwiPGJyPlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG5vdHkoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtc2csXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dDogJ3RvcENlbnRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDUwMDBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4pO1xyXG4iLCJhZHNBcHAuZmFjdG9yeSgnYWRzRGF0YScsIFtcclxuICAgICckcmVzb3VyY2UnLFxyXG4gICAgJ2F1dGhlbnRpY2F0aW9uJyxcclxuICAgICdiYXNlU2VydmljZVVybCcsXHJcbiAgICBmdW5jdGlvbiAoJHJlc291cmNlLCBhdXRoZW50aWNhdGlvbiwgYmFzZVNlcnZpY2VVcmwpIHtcclxuICAgICAgICB2YXIgcmVzb3VyY2UgPSAkcmVzb3VyY2UoYmFzZVNlcnZpY2VVcmwgKyAnYWRzLzphZElkJywge2FkSWQ6ICdAaWQnfSwge1xyXG4gICAgICAgICAgICB1cGRhdGU6IHttZXRob2Q6ICdQVVQnfSxcclxuICAgICAgICAgICAgZ2V0QWxsOiB7bWV0aG9kOiAnR0VUJ31cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlQWQoYWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnNhdmUoYWQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UHVibGljQWRzKHBhcmFtcykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzb3VyY2UuZ2V0QWxsKHBhcmFtcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlZGl0QWQoYWRJZCwgYWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnVwZGF0ZSh7aWQ6IGFkSWR9LCBhZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhZGQ6IGNyZWF0ZUFkLFxyXG4gICAgICAgICAgICBnZXRQdWJsaWNBZHM6IGdldFB1YmxpY0FkcyxcclxuICAgICAgICAgICAgZWRpdDogZWRpdEFkXHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xyXG4iLCJhZHNBcHAuZmFjdG9yeSgnY2F0ZWdvcmllc0RhdGEnLCBbJyRyZXNvdXJjZScsICdiYXNlU2VydmljZVVybCcsIGZ1bmN0aW9uICgkcmVzb3VyY2UsIGJhc2VTZXJ2aWNlVXJsKSB7XHJcbiAgICB2YXIgcmVzb3VyY2UgPSAkcmVzb3VyY2UoYmFzZVNlcnZpY2VVcmwgKyAnY2F0ZWdvcmllcycpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGdldENhdGVnb3JpZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc291cmNlLnF1ZXJ5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBnZXRDYXRlZ29yaWVzOiBnZXRDYXRlZ29yaWVzXHJcbiAgICB9XHJcbn1dKTtcclxuIiwiYWRzQXBwLmZhY3RvcnkoJ3Rvd25zRGF0YScsIFsnJHJlc291cmNlJywgJ2Jhc2VTZXJ2aWNlVXJsJywgZnVuY3Rpb24gKCRyZXNvdXJjZSwgYmFzZVNlcnZpY2VVcmwpIHtcclxuICAgIHZhciByZXNvdXJjZSA9ICRyZXNvdXJjZShiYXNlU2VydmljZVVybCArICd0b3ducycpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGdldFRvd25zKCkge1xyXG4gICAgICAgIHJldHVybiByZXNvdXJjZS5xdWVyeSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZ2V0VG93bnM6IGdldFRvd25zXHJcbiAgICB9XHJcbn1dKTtcclxuIiwiYWRzQXBwLmZhY3RvcnkoJ3VzZXJBZHNEYXRhJywgW1xyXG4gICAgJyRyZXNvdXJjZScsXHJcbiAgICAnYXV0aGVudGljYXRpb24nLFxyXG4gICAgJ2Jhc2VTZXJ2aWNlVXJsJyxcclxuICAgIGZ1bmN0aW9uICgkcmVzb3VyY2UsIGF1dGhlbnRpY2F0aW9uLCBiYXNlU2VydmljZVVybCkge1xyXG4gICAgICAgIHZhciByZXNvdXJjZSA9ICRyZXNvdXJjZShiYXNlU2VydmljZVVybCArICd1c2VyL2Fkcy86YWRJZCcsIHthZElkOiAnQGlkJ30sIHtcclxuICAgICAgICAgICAgdXBkYXRlOiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczogYXV0aGVudGljYXRpb24uZ2V0SGVhZGVycygpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldEFsbDoge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGF1dGhlbnRpY2F0aW9uLmdldEhlYWRlcnMoKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXQ6IHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBhdXRoZW50aWNhdGlvbi5nZXRIZWFkZXJzKClcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVtb3ZlOiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczogYXV0aGVudGljYXRpb24uZ2V0SGVhZGVycygpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNhdmU6IHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczogYXV0aGVudGljYXRpb24uZ2V0SGVhZGVycygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV3QWQoYWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnNhdmUoYWQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckFkcyhwYXJhbXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLmdldEFsbChwYXJhbXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWRCeUlkKGFkSWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLmdldCh7YWRJZDogYWRJZH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZWRpdEFkKGFkSWQsIGFkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZS51cGRhdGUoe2FkSWQ6IGFkSWR9LCBhZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkZWFjdGl2YXRlQWQoYWRJZCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzb3VyY2UgPSAkcmVzb3VyY2UoYmFzZVNlcnZpY2VVcmwgKyAndXNlci9hZHMvZGVhY3RpdmF0ZS86YWRJZCcsIHthZElkOiAnQGlkJ30sIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogYXV0aGVudGljYXRpb24uZ2V0SGVhZGVycygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnVwZGF0ZSh7aWQ6IGFkSWR9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHB1Ymxpc2hBZ2FpbkFkKGFkSWQpIHtcclxuICAgICAgICAgICAgdmFyIHJlc291cmNlID0gJHJlc291cmNlKGJhc2VTZXJ2aWNlVXJsICsgJ3VzZXIvYWRzL3B1Ymxpc2hhZ2Fpbi86YWRJZCcsIHthZElkOiAnQGlkJ30sIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogYXV0aGVudGljYXRpb24uZ2V0SGVhZGVycygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnVwZGF0ZSh7aWQ6IGFkSWR9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZUFkKGFkSWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnJlbW92ZSh7YWRJZDogYWRJZH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYWRkOiBjcmVhdGVOZXdBZCxcclxuICAgICAgICAgICAgZ2V0VXNlckFkczogZ2V0VXNlckFkcyxcclxuICAgICAgICAgICAgZ2V0QWRCeUlkOiBnZXRBZEJ5SWQsXHJcbiAgICAgICAgICAgIGVkaXQ6IGVkaXRBZCxcclxuICAgICAgICAgICAgZGVhY3RpdmF0ZTogZGVhY3RpdmF0ZUFkLFxyXG4gICAgICAgICAgICBwdWJsaXNoQWdhaW46IHB1Ymxpc2hBZ2FpbkFkLFxyXG4gICAgICAgICAgICBkZWxldGU6IHJlbW92ZUFkXHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xyXG4iLCJhZHNBcHAuZmFjdG9yeSgndXNlckRhdGEnLCBbXHJcbiAgICAnJGh0dHAnLFxyXG4gICAgJyRyZXNvdXJjZScsXHJcbiAgICAnYmFzZVNlcnZpY2VVcmwnLFxyXG4gICAgJ2F1dGhlbnRpY2F0aW9uJyxcclxuICAgIGZ1bmN0aW9uICgkaHR0cCwgJHJlc291cmNlLCBiYXNlU2VydmljZVVybCwgYXV0aGVudGljYXRpb24pIHtcclxuXHJcbiAgICAgICAgdmFyIHVzZXJTZXJ2aWNlVXJsID0gYmFzZVNlcnZpY2VVcmwgKyAndXNlci8nO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRVc2VyUHJvZmlsZSgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc291cmNlID0gJHJlc291cmNlKHVzZXJTZXJ2aWNlVXJsICsgJ3Byb2ZpbGUnLCB7fSwge1xyXG4gICAgICAgICAgICAgICAgZ2V0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBhdXRoZW50aWNhdGlvbi5nZXRIZWFkZXJzKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzb3VyY2UuZ2V0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZWdpc3RlclVzZXIodXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gJHJlc291cmNlKHVzZXJTZXJ2aWNlVXJsICsgJ3JlZ2lzdGVyJylcclxuICAgICAgICAgICAgICAgIC5zYXZlKHVzZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbG9naW5Vc2VyKHVzZXIpIHtcclxuICAgICAgICAgICAgdmFyIHJlc291cmNlID0gJHJlc291cmNlKHVzZXJTZXJ2aWNlVXJsICsgJ2xvZ2luJylcclxuICAgICAgICAgICAgICAgIC5zYXZlKHVzZXIpO1xyXG5cclxuICAgICAgICAgICAgcmVzb3VyY2UuJHByb21pc2VcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0aGVudGljYXRpb24uc2F2ZVVzZXIoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVkaXRVc2VyUHJvZmlsZSh1c2VyKSB7XHJcbiAgICAgICAgICAgIHZhciByZXNvdXJjZSA9ICRyZXNvdXJjZSh1c2VyU2VydmljZVVybCArICdwcm9maWxlJywge30sIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogYXV0aGVudGljYXRpb24uZ2V0SGVhZGVycygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnVwZGF0ZSh1c2VyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNoYW5nZVVzZXJQYXNzd29yZChwYXNzKSB7XHJcbiAgICAgICAgICAgIHZhciByZXNvdXJjZSA9ICRyZXNvdXJjZSh1c2VyU2VydmljZVVybCArICdjaGFuZ2VQYXNzd29yZCcsIHt9LCB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGF1dGhlbnRpY2F0aW9uLmdldEhlYWRlcnMoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZS51cGRhdGUocGFzcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XHJcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0aW9uLnJlbW92ZVVzZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldFVzZXJQcm9maWxlOiBnZXRVc2VyUHJvZmlsZSxcclxuICAgICAgICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyVXNlcixcclxuICAgICAgICAgICAgbG9naW46IGxvZ2luVXNlcixcclxuICAgICAgICAgICAgZWRpdDogZWRpdFVzZXJQcm9maWxlLFxyXG4gICAgICAgICAgICBjaGFuZ2VQYXNzd29yZDogY2hhbmdlVXNlclBhc3N3b3JkLFxyXG4gICAgICAgICAgICBsb2dvdXQ6IGxvZ291dFxyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9